{"version":3,"file":"disconnect.js","sourceRoot":"","sources":["../../../src/handlers/websocket/disconnect.ts"],"names":[],"mappings":";;;AACA,8DAA0D;AAC1D,wDAA8E;AAE9E,MAAM,YAAY,GAAG,IAAI,gCAAc,CAAC,EAAE,CAAC,CAAC;AAC5C,MAAM,SAAS,GAAG,qCAAsB,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;AAErD,MAAM,OAAO,GAAG,KAAK,EAC1B,KAA2B,EACK,EAAE;IAClC,MAAM,YAAY,GAAG,KAAK,CAAC,cAAc,CAAC,YAAa,CAAC;IAExD,OAAO,CAAC,GAAG,CAAC,0BAA0B,EAAE,EAAE,YAAY,EAAE,CAAC,CAAC;IAE1D,IAAI,CAAC;QACH,kCAAkC;QAClC,MAAM,SAAS,CAAC,IAAI,CAClB,IAAI,4BAAa,CAAC;YAChB,SAAS,EAAE,OAAO,CAAC,GAAG,CAAC,sBAAuB;YAC9C,GAAG,EAAE,EAAE,YAAY,EAAE;SACtB,CAAC,CACH,CAAC;QAEF,OAAO;YACL,UAAU,EAAE,GAAG;YACf,IAAI,EAAE,IAAI,CAAC,SAAS,CAAC,EAAE,OAAO,EAAE,2BAA2B,EAAE,CAAC;SAC/D,CAAC;IACJ,CAAC;IAAC,OAAO,KAAK,EAAE,CAAC;QACf,OAAO,CAAC,KAAK,CAAC,4BAA4B,EAAE,KAAK,CAAC,CAAC;QACnD,OAAO;YACL,UAAU,EAAE,GAAG;YACf,IAAI,EAAE,IAAI,CAAC,SAAS,CAAC,EAAE,OAAO,EAAE,sBAAsB,EAAE,CAAC;SAC1D,CAAC;IACJ,CAAC;AACH,CAAC,CAAC;AA3BW,QAAA,OAAO,WA2BlB","sourcesContent":["import { APIGatewayProxyEvent, APIGatewayProxyResult } from 'aws-lambda';\nimport { DynamoDBClient } from '@aws-sdk/client-dynamodb';\nimport { DynamoDBDocumentClient, DeleteCommand } from '@aws-sdk/lib-dynamodb';\n\nconst dynamoClient = new DynamoDBClient({});\nconst docClient = DynamoDBDocumentClient.from(dynamoClient);\n\nexport const handler = async (\n  event: APIGatewayProxyEvent\n): Promise<APIGatewayProxyResult> => {\n  const connectionId = event.requestContext.connectionId!;\n\n  console.log('WebSocket disconnection:', { connectionId });\n\n  try {\n    // Remove connection from DynamoDB\n    await docClient.send(\n      new DeleteCommand({\n        TableName: process.env.CONNECTIONS_TABLE_NAME!,\n        Key: { connectionId },\n      })\n    );\n\n    return {\n      statusCode: 200,\n      body: JSON.stringify({ message: 'Disconnected successfully' }),\n    };\n  } catch (error) {\n    console.error('Error removing connection:', error);\n    return {\n      statusCode: 500,\n      body: JSON.stringify({ message: 'Failed to disconnect' }),\n    };\n  }\n};"]}